MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (__CONFIG)
2007   3FBB           00001 __CONFIG _CP_OFF & _WDT_OFF & _BODEN_OFF & _PWRTE_OFF & _RC_OSC & _LVP_ON & _DEBUG_OFF & _CPD_OFF
Warning[215]: Processor superseded by command line.  Verify processor symbol.
                      00002     LIST P=16F877A
                      00003     INCLUDE<P16F877A.INC>    ;Librería para el PIC16F877A
                      00001         LIST
                      00002 ; P16F877A.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.
Message[301]: MESSAGE: (Processor-header file mismatch.  Verify selected processor.)
                      00400         LIST
                      00004 
  00000003            00005 ESTADO  EQU             0x03
  00000005            00006 PORTA   EQU             0x05
  00000006            00007 PORTB   EQU             0x06
  00000008            00008 PORTD   EQU             0x08
  00000007            00009 PORTC   EQU             0x07
  00000085            00010 TRISA   EQU             0x85
  00000086            00011 TRISB   EQU             0x86
  00000087            00012 TRISC   EQU             0x87
  00000088            00013 TRISD   EQU             0x88
  0000000C            00014 CONT0   EQU             0x0C
  0000001C            00015 CONT1   EQU             0x1C
  0000000E            00016 MONTO   EQU             0x0E
  0000000F            00017 AUX             EQU             0x0F
  0000001C            00018 AUX2    EQU             1CH
  0000009F            00019 ADCON   EQU             9FH
  00000089            00020 TRISE   EQU             89H
                      00021 #DEFINE LEDROJO PORTC,3;                para definir nuestras salidas y 
                      00022 #DEFINE LEDROJO2        PORTC,4;        usarlas mas facilmente
                      00023 #DEFINE LEDAMAR PORTC,5
                      00024 #DEFINE LEDVERD PORTC,6
                      00025 #DEFINE LEDAZUL PORTC,7
                      00026 
0000                  00027                 ORG             0x00
0000   2801           00028                 GOTO    INICIO
0001   1683           00029 INICIO  BSF             STATUS,5                ; BANK1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0002   0185           00030                 CLRF    TRISA                   ; RA0-RA2 -> Display    
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0003   1585           00031                 BSF             TRISA,3                 ; RA3<- ENTRADA SELECTCAFE
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0004   1605           00032                 BSF             TRISA,4                 ; RA4<- ENTRADA START
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0005   0186           00033                 CLRF    TRISB                   ; RB4-RB7-> LR LA LV LAZ LR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0006   0187           00034                 CLRF    TRISC
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0007   0188           00035                 CLRF    TRISD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0008   1407           00036                 BSF             TRISC,0                 ; RB0<-ENTRADA MONEDA1BS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0009   1487           00037                 BSF             TRISC,1                 ; RB1<-ENTRADA MONEDA2BS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000A   1507           00038                 BSF             TRISC,2                 ; RB2<-ENTRADA MONEDA5BS
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00039                 
000B   3007           00040         MOVLW   0x07 ; Configure all pins
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000C   009F           00041         MOVWF   ADCON
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   1209           00042         BCF             TRISE,4
000E   1283           00043                 BCF             STATUS,5                ; BANK0
                      00044 
000F   0185           00045 START   CLRF    PORTA                   ; DP=0
0010   0187           00046                 CLRF    PORTC
0011   0188           00047                 CLRF    PORTD
0012   0186           00048                 CLRF    PORTB                   ; LR=LA=LV=LAZ=LR=OFF
0013   018E           00049                 CLRF    MONTO                   ; MONEY=0
0014   018F           00050                 CLRF    AUX                             ; AUX=0
0015   019C           00051                 CLRF    AUX2
0016   2041           00052 ES1BS   CALL    SELECCAFE
0017   1807           00053                 BTFSC   PORTC,0                 ; MONEDA1BS=0?                                          
                                    SWITCH 1 BS
0018   2822           00054                 GOTO    ES2BS
0019   228B           00055                 CALL    DELAY
001A   3007           00056                 MOVLW   0x07                    ; W<-7
001B   1003           00057                 BCF             ESTADO,0                ; C=0;
001C   020E           00058                 SUBWF   MONTO,0                 ; W=MONEY-W
001D   1803           00059                 BTFSC   ESTADO,0                ; C=0? - MONEY<7?       
001E   283D           00060                 GOTO    MONTODEMAS              ; RECHAZA LA MONEDA  
001F   3001           00061                 MOVLW   0x01                    ; W<-1
0020   078E           00062                 ADDWF   MONTO,1                 ; MONTO=MONTO+1BS
0021   283A           00063                 GOTO    MOSTRAR
0022   2041           00064 ES2BS   CALL    SELECCAFE
0023   1887           00065                 BTFSC   PORTC,1                 ; MONEDA2BS=0?                                          
                                    SWITCH 2 BS
0024   282E           00066                 GOTO    ES5BS
0025   228B           00067                 CALL    DELAY
0026   3006           00068                 MOVLW   0x06                    ; W<-6
0027   1003           00069                 BCF             ESTADO,0                ; C=0;
0028   020E           00070                 SUBWF   MONTO,0                 ; W=MONTO-6
0029   1803           00071                 BTFSC   ESTADO,0                ; C=0? - MONEY<6?       
002A   283D           00072                 GOTO    MONTODEMAS              ; RECHAZA LA MONEDA
002B   3002           00073                 MOVLW   0x02                    ; W<-2
002C   078E           00074                 ADDWF   MONTO,1                 ; MONTO=MONTO+2BS
002D   283A           00075                 GOTO    MOSTRAR
002E   2041           00076 ES5BS   CALL    SELECCAFE
002F   1907           00077                 BTFSC   PORTC,2                 ; SW5BS=0?                                              
                                    SWITCH 5 BS
0030   2816           00078                 GOTO    ES1BS
0031   228B           00079                 CALL    DELAY
0032   3005           00080                 MOVLW   0x05                    ; W<-3
0033   1003           00081                 BCF             ESTADO,0                ; C=0;
0034   020E           00082                 SUBWF   MONTO,0                 ; W=MONEY-W
0035   1803           00083                 BTFSC   ESTADO,0                ; C=0? - MONEY<3?       
0036   283D           00084                 GOTO    MONTODEMAS                      ; RECHAZA LA MONEDA 
0037   3005           00085                 MOVLW   0x05                    ; W<-5
0038   078E           00086                 ADDWF   MONTO,1                 ; MONEY=MONEY+W
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0039   283A           00087                 GOTO    MOSTRAR
003A   080E           00088 MOSTRAR MOVF    MONTO,0                 ; W=MONEY                                               MOSTRAR 
                            CANTIDAD DE DINERO
003B   0088           00089                 MOVWF   PORTD                   ; DP=W
003C   2816           00090                 GOTO    ES1BS
003D                  00091 MONTODEMAS
003D   1787           00092                 BSF             LEDAZUL                 ; LED CAMBIO=ON
003E   228B           00093                 CALL    DELAY
003F   1387           00094                 BCF             LEDAZUL                 ; LED CAMBIO=OFF
0040   2816           00095                 GOTO    ES1BS
0041                  00096 SELECCAFE
0041   2054           00097                 CALL    START2
0042   1985           00098                 BTFSC   PORTA,3                 ; MONEDA1BS=0?                                          
                                    SWITCH 1 BS
0043   0008           00099                 RETURN
0044   228B           00100                 CALL    DELAY
0045   3001           00101                 MOVLW   0x01                    ; W<-1
0046   078F           00102                 ADDWF   AUX,1                   ; MONTO=MONTO+1BS
0047   2049           00103                 CALL    CHECK
                      00104 
0048   2851           00105                 GOTO    MOSTRAR2
                      00106                 
0049                  00107 CHECK;                                                  PARA QUE EL SW SELEC NO SE PASE DE 4
0049   3005           00108                 MOVLW   0x05                    ; W<-5
004A   1003           00109                 BCF             ESTADO,0                ; C=0;
004B   020F           00110                 SUBWF   AUX,0                   ; W=MONEY-W
004C   1C03           00111                 BTFSS   ESTADO,0                ; C=0? - MONEY<5?       
004D   0008           00112                 RETURN;                                 SI NO retorna
004E   018F           00113                 CLRF    AUX;                    ;si si borra la variable select
004F   0185           00114                 CLRF    PORTA
0050   0008           00115                 RETURN
0051                  00116 MOSTRAR2
0051   080F           00117                 MOVF    AUX,0                   ; W=MONEY               muestra el dinero
0052   0088           00118                 MOVWF   PORTD                   ; DP=W
0053   2841           00119                 GOTO    SELECCAFE;              vamos a seleccionar que cafe
0054                  00120 START2;                                                 se apreto start??
0054   1A05           00121                 BTFSC   PORTA,4
0055   0008           00122                 RETURN;                                 si no sigue en lo que estaba
0056   080E           00123                 MOVF    MONTO,0;                si si, hace  w<-monto
0057   009C           00124                 MOVWF   AUX2
Warning[202]: Argument out of range.  Least significant bits used.
0058   080E           00125                 MOVF    MONTO,AUX2; HACEMOS AUXTEM<-CONTEMP
0059                  00126 CAFEPURO
0059   1003           00127                 BCF             ESTADO,0                ; C=0;
005A   3001           00128                 MOVLW   0x01                    ; W<-1
005B   020E           00129                 SUBWF   MONTO,W                 ; W=MONEY-W
005C   1C03           00130                 BTFSS   ESTADO,0                ; C=1? - MONEY>=1?      
005D   2816           00131                 GOTO    ES1BS;                  si no vuelve a pedir dinero
005E   1103           00132                 BCF             ESTADO,2;               si si, continua
005F   3001           00133                 MOVLW   0X01;                   w<-1
0060   020F           00134                 SUBWF   AUX,W                   ;AUX es 1?
0061   1D03           00135                 BTFSS   ESTADO,2
0062   2865           00136                 GOTO    CAFELECHE;      si no pregunta el siguiente
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00137 ;CALL   MSJ1
0063   1587           00138         BSF             LEDROJO;                si si prende el led ROJO y devuelve el cambio
                      00139                 
0064   2888           00140                 GOTO    CUANTODECAMBIO
                      00141 
0065                  00142 CAFELECHE
0065   1003           00143                 BCF             ESTADO,0                ; C=0;
0066   3002           00144                 MOVLW   0x02                    ; W<-2
0067   020E           00145                 SUBWF   MONTO,W                 ; W=MONEY-W
0068   1C03           00146                 BTFSS   ESTADO,0                ; C=1? - MONEY>=2?      
0069   2816           00147                 GOTO    ES1BS;                  si no vuelve a pedir dinero
006A   1103           00148                 BCF             ESTADO,2;               si si, continua
006B   3002           00149                 MOVLW   0X02;                   w<-2
006C   020F           00150                 SUBWF   AUX,W                   ;AUX es 2?
006D   1D03           00151                 BTFSS   ESTADO,2
006E   2871           00152                 GOTO    CAFEEXPRESS;    si no pregunta el siguiente
006F   1687           00153                 BSF             LEDAMAR;                si si prende el led AMARILLO y devuelve el cambi
                            o
                      00154                 
0070   2888           00155                 GOTO    CUANTODECAMBIO
                      00156 ;CALL   MSJ2
0071                  00157 CAFEEXPRESS
0071   1003           00158                 BCF             ESTADO,0                ; C=0;
0072   3003           00159                 MOVLW   0x03                    ; W<-3
0073   020E           00160                 SUBWF   MONTO,W                 ; W=MONEY-W
0074   1C03           00161                 BTFSS   ESTADO,0                ; C=1? - MONEY>=3?      
0075   2816           00162                 GOTO    ES1BS;                  si no vuelve a pedir dinero
0076   1103           00163                 BCF             ESTADO,2;               si si, continua
0077   3003           00164                 MOVLW   0X03;                   w<-3
0078   020F           00165                 SUBWF   AUX,W                   ;AUX es 3?
0079   1D03           00166                 BTFSS   ESTADO,2
007A   287D           00167                 GOTO    CAFECAPUCCINO;  si no pregunta el siguiente
007B   1707           00168                 BSF             LEDVERD;                si si prende el led verde y devuelve el cambio
                      00169                 
007C   2888           00170                 GOTO    CUANTODECAMBIO
                      00171 ;               CALL    MSJ3
007D                  00172 CAFECAPUCCINO
007D   1003           00173                 BCF             ESTADO,0                ; C=0;
007E   3004           00174                 MOVLW   0x04                    ; W<-4
007F   020E           00175                 SUBWF   MONTO,W                 ; W=MONEY-W
0080   1C03           00176                 BTFSS   ESTADO,0                ; C=1? - MONEY>=4?      
0081   2816           00177                 GOTO    ES1BS;                  si no vuelve a pedir dinero
0082   1103           00178                 BCF             ESTADO,2;               si si, continua
0083   3004           00179                 MOVLW   0X04;                   w<-4
0084   020F           00180                 SUBWF   AUX,W                   ;AUX es 4?
0085   1D03           00181                 BTFSS   ESTADO,2
0086   2871           00182                 GOTO    CAFEEXPRESS;    si no pregunta el siguiente
                      00183         ;       CALL    MSJ4
0087   1607           00184                 BSF             LEDROJO2;               si si prende el led ROJO2 y devuelve el cambio
0088                  00185 CUANTODECAMBIO
0088   1103           00186                 BCF             ESTADO,2;               borramos zero de status
0089   080F           00187                 MOVF    AUX,0;                  movemos el aux a W
008A   020E           00188                 SUBWF   MONTO,W;                hacemos monto-w
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008B   008E           00189 CAMBIO  MOVWF   MONTO;                  movemos el resultado de la resta a w
008C   1787           00190                 BSF             LEDAZUL                 ; prendemos el led azul de devolver cambio      
                                                                SI HAY CAMBIO ENCIENDE LA LUZ DE CAMBIO
008D   080E           00191 SINC    MOVF    MONTO,0                 ; W<-MONEY                                                      
                                            SI NO HAY CAMBIO VIENE ACA
008E   0088           00192                 MOVWF   PORTD
                      00193                         ; DP<-W
008F   229C           00194                 CALL    DELAY2
0090   229C           00195                 CALL    DELAY2
0091   229C           00196                 CALL    DELAY2
Warning[203]: Found opcode in column 1. (CALL)
0092   209E           00197 CALL    MSJ2
0093   280F           00198                 GOTO    START
Warning[203]: Found opcode in column 1. (RETURN)
0094   0008           00199 RETURN
                      00200 
                      00201 
                      00202 
0095                  00203 MSJ1
0095   21B8           00204         call    LCD_Inicializa                  ; Prepara la pantalla.
0096   30AB           00205         movlw   Mensaje1
0097   2190           00206         call    LCD_Mensaje
                      00207 
Warning[203]: Found opcode in column 1. (CALL)
0098   228B           00208 CALL DELAY
                      00209 
0099   21B8           00210         call    LCD_Inicializa                  ; Prepara la pantalla.
Warning[202]: Argument out of range.  Least significant bits used.
009A   300D           00211         movlw   Mensaje11                               ; Apunta al mensaje.
009B   219E           00212         call    LCD_MensajeMovimiento
                      00213 ;       goto    Principal2                              ; Repite la visualización.
Warning[203]: Found opcode in column 1. (CALL)
009C   228B           00214 CALL DELAY
Warning[203]: Found opcode in column 1. (RETURN)
009D   0008           00215 RETURN
                      00216 
009E                  00217 MSJ2
009E   21B8           00218         call    LCD_Inicializa                  ; Prepara la pantalla.
Warning[202]: Argument out of range.  Least significant bits used.
009F   3046           00219         movlw   Mensaje2
00A0   2190           00220         call    LCD_Mensaje
                      00221 
Warning[203]: Found opcode in column 1. (RETURN)
00A1   0008           00222 RETURN
                      00223 
00A2                  00224 MSJ3
00A2   21B8           00225         call    LCD_Inicializa                  ; Prepara la pantalla.
Warning[202]: Argument out of range.  Least significant bits used.
00A3   3056           00226         movlw   Mensaje3
00A4   2190           00227         call    LCD_Mensaje
                      00228 
Warning[203]: Found opcode in column 1. (RETURN)
00A5   0008           00229 RETURN
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A6                  00230 MSJ4
00A6   21B8           00231         call    LCD_Inicializa                  ; Prepara la pantalla.
Warning[202]: Argument out of range.  Least significant bits used.
00A7   3067           00232         movlw   Mensaje4
00A8   2190           00233         call    LCD_Mensaje
                      00234 
Warning[203]: Found opcode in column 1. (RETURN)
00A9   0008           00235 RETURN
00AA                  00236 Mensajes
00AA   0782           00237         addwf   PCL,F
00AB                  00238 Mensaje1                                                        ; Posición inicial del mensaje.
00AB   3443 3441 3446 00239         DT "CAFE PURO 1 Bs   "                  ; Espacios en blanco al principio para mejor
       3445 3420 3450 
       3455 3452 344F 
       3420 3431 3420 
       3442 3473 3420 
       3420 3420 
00BC   3420 3420 3420 00240         DT "                         "
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 
00D5   3420 3420 3420 00241         DT "                      "     ; visualización.
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 
00EB   3452 3445 3443 00242         DT "RECIBA SU CAMBIO "
       3449 3442 3441 
       3420 3453 3455 
       3420 3443 3441 
       344D 3442 3449 
       344F 3420 
00FC   3420 3420 3420 00243         DT "                ", 0x0              ; Espacios en blanco al final.
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3400 
010D                  00244 Mensaje11                                                       ; Posición inicial del mensaje.
010D   3420 3420 3420 00245         DT "                 "                  ; Espacios en blanco al principio para mejor
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

011E   3450 3452 3445 00246         DT "PREPARANDO...  "
       3450 3441 3452 
       3441 344E 3444 
       344F 342E 342E 
       342E 3420 3420 
012D   3447 3452 3441 00247         DT "GRACIAS. VUELVA PRONTO  "   ; visualización.
       3443 3449 3441 
       3453 342E 3420 
       3456 3455 3445 
       344C 3456 3441 
       3420 3450 3452 
       344F 344E 3454 
       344F 3420 3420 
                      00248  ;      DT "                ", 0x0              ; Espacios en blanco al final.
Warning[203]: Found opcode in column 1. (GOTO)
0145   2859           00249 GOTO    CAFEPURO
0146                  00250 MensajesA
0146                  00251 Mensaje2                                                ; Posición inicial del mensaje.
0146   3443 3441 3446 00252         DT "CAFE C/LECH 2 Bs"                   ; Espacios en blanco al principio para mejor
       3445 3420 3443 
       342F 344C 3445 
       3443 3448 3420 
       3432 3420 3442 
       3473 
                      00253 ;       DT "                         "
                      00254 ;       DT "                     "      ; visualización.
                      00255 ;       DT "RECIBA SU CAMBIO "
                      00256 ;       DT "                ", 0x0              ; Espacios en blanco al final.
                      00257 
0156                  00258 Mensaje3                                                        ; Posición inicial del mensaje.
0156   3443 3441 3446 00259         DT "CAFE EXPRES 3 Bs"                   ; Espacios en blanco al principio para mejor
       3445 3420 3445 
       3458 3450 3452 
       3445 3453 3420 
       3433 3420 3442 
       3473 
                      00260 ;       DT "                         "
                      00261 ;       DT "                     "      ; visualización.
                      00262 ;       DT "RECIBA SU CAMBIO "
                      00263 ;       DT "                ", 0x0              ; Espacios en blanco al final.
                      00264 ;CLEAR  DISPLAY
Warning[203]: Found opcode in column 1. (GOTO)
0166   2859           00265 GOTO    CAFEPURO
0167                  00266 Mensaje4                                                        ; Posición inicial del mensaje.
0167   3443 3441 3450 00267         DT "CAPUCCINO 4 Bs  "                   ; Espacios en blanco al principio para mejor
       3455 3443 3443 
       3449 344E 344F 
       3420 3434 3420 
       3442 3473 3420 
       3420 
0177   3420 3420 3420 00268         DT "                         "
       3420 3420 3420 
       3420 3420 3420 
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 3420 3420 
       3420 
                      00269 ;       DT "                     "      ; visualización.
                      00270 ;       DT "RECIBA SU CAMBIO "
                      00271 ;       DT "                ", 0x0              ; Espacios en blanco al final.
                      00272 
                      00273         INCLUDE  <LCD_MENS.INC>                 ; Subrutina LCD_MensajeMovimiento.
                      00001 ;**************************** Librería "LCD_MENS.INC" ********************************
                      00002 ;
                      00003 ;       ===================================================================
                      00004 ;         Del libro "MICROCONTROLADOR PIC16F84. DESARROLLO DE PROYECTOS"
                      00005 ;         E. Palacios, F. Remiro y L. López.            www.pic16f84a.com
                      00006 ;         Editorial Ra-Ma.  www.ra-ma.es
                      00007 ;       ===================================================================
                      00008 ;
                      00009 ; Librería de subrutinas para el manejo de mensajes a visualizar en un visualizador LCD.
                      00010 
Message[313]: CBLOCK constants will start with a value of 0.
                      00011         CBLOCK
  00000000            00012         LCD_ApuntaCaracter                              ; Indica la posición del carácter a visualizar
                      00013                                                                         ; respecto del comienzo de todos
                             los mensajes,
                      00014                                                                         ; (posición de la etiqueta "Mens
                            ajes").
  00000001            00015         LCD_ValorCaracter                               ; Código ASCII del carácter a 
                      00016         ENDC                                                    ; visualizar.
                      00017 
                      00018 ; Los mensajes tienen que estar situados dentro de las 256 primeras posiciones de la 
                      00019 ; memoria de programa, es decir, no pueden superar la dirección 0FFh.
                      00020 
                      00021 ; Subrutina "LCD_Mensaje" ---------------------------------------------------------------
                      00022 ;
                      00023 ; Visualiza por pantalla el mensaje apuntado por el registro W.
                      00024 ;
                      00025 ; Los mensajes deben localizarse dentro de una zona encabezada por la etiqueta "Mensajes" y que
                      00026 ; tenga la siguiente estructura:
                      00027 ;
                      00028 ; Mensajes                                                      ; ¡Etiqueta obligatoria!
                      00029 ;       addwf   PCL,F
                      00030 ; Mensaje0                                                      ; Posición inicial del mensaje.
                      00031 ;       DT ".. ..", 0x00                                ; Mensaje terminado en 0x00.
                      00032 ; Mensaje1
                      00033 ;       ...     
                      00034 ;       ...
                      00035 ; FinMensajes
                      00036 ;
                      00037 ; La llamada a esta subrutina se realizará siguiendo este ejemplo:
                      00038 ;
                      00039 ;       movlw   Mensaje0                                ; Carga la posición del mensaje.
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00040 ;       call    LCD_Mensaje                             ; Visualiza el mensaje.
                      00041 ;
0190                  00042 LCD_Mensaje
0190   0080           00043         movwf   LCD_ApuntaCaracter              ; Posición del primer carácter del mensaje.
0191   30AA           00044         movlw   Mensajes                                ; Halla la posición relativa del primer carácter
0192   0280           00045         subwf   LCD_ApuntaCaracter,F    ; del mensaje respecto de etiqueta "Mensajes".
0193   0380           00046         decf    LCD_ApuntaCaracter,F    ; Compensa la posición que ocupa "addwf PCL,F".
0194                  00047 LCD_VisualizaOtroCaracter
0194   0800           00048         movf    LCD_ApuntaCaracter,W
0195   20AA           00049         call    Mensajes                                ; Obtiene el código ASCII del carácter apuntado.
0196   0081           00050         movwf   LCD_ValorCaracter               ; Guarda el valor de carácter.
0197   0881           00051         movf    LCD_ValorCaracter,F             ; Lo único que hace es posicionar flag Z. En caso
0198   1903           00052         btfsc   STATUS,Z                                ; que sea "0x00", que es código indicador final 
0199   299D           00053         goto    LCD_FinMensaje                  ; de mensaje, sale fuera.
019A                  00054 LCD_NoUltimoCaracter
019A   2201           00055         call    LCD_Caracter                    ; Visualiza el carácter ASCII leído.
019B   0A80           00056         incf    LCD_ApuntaCaracter,F    ; Apunta a la posición del siguiente carácter 
019C   2994           00057         goto    LCD_VisualizaOtroCaracter       ; dentro del mensaje.
019D                  00058 LCD_FinMensaje
019D   0008           00059         return                                                  ; Vuelve al programa principal.
                      00060 
                      00061 ; Subrutina "LCD_MensajeMovimiento" -----------------------------------------------------
                      00062 ;
                      00063 ; Visualiza un mensaje de mayor longitud que los 16 caracteres que pueden representarse
                      00064 ; en una línea, por tanto se desplaza a través de la pantalla.
                      00065 ;
                      00066 ; En el mensaje debe dejarse 16 espacios en blanco, al principio y al final para
                      00067 ; conseguir que el desplazamiento del mensaje sea lo más legible posible.
                      00068 ;
                      00069         CBLOCK  
  00000002            00070         LCD_CursorPosicion                              ; Contabiliza la posición del cursor dentro de l
                            a
                      00071         ENDC                                                    ; pantalla LCD
                      00072 
019E                  00073 LCD_MensajeMovimiento
019E   0080           00074         movwf   LCD_ApuntaCaracter              ; Posición del primer carácter del mensaje.
019F   30AA           00075         movlw   Mensajes                                ; Halla la posición relativa del primer carácter
01A0   0280           00076         subwf   LCD_ApuntaCaracter,F    ; del mensaje respecto de la etiqueta "Mensajes".
01A1   0380           00077         decf    LCD_ApuntaCaracter,F    ; Compensa la posición que ocupa "addwf PCL,F".
01A2                  00078 LCD_PrimeraPosicion
01A2   0182           00079         clrf    LCD_CursorPosicion              ; El cursor en la posición 0 de la línea.
01A3   21FC           00080         call    LCD_Borra                               ; Se sitúa en la primera posición de la línea 1 
                            y
01A4                  00081 LCD_VisualizaCaracter                           ; borra la pantalla.
01A4   3010           00082         movlw   LCD_CaracteresPorLinea  ; ¿Ha llegado a final de línea?
01A5   0202           00083         subwf   LCD_CursorPosicion,W
01A6   1D03           00084         btfss   STATUS,Z
01A7   29AD           00085         goto    LCD_NoEsFinalLinea
01A8                  00086 LCD_EsFinalLinea
01A8   225B           00087         call    Retardo_200ms                   ; Lo mantiene visualizado durante este tiempo.
01A9   225B           00088         call    Retardo_200ms
01AA   300F           00089         movlw   LCD_CaracteresPorLinea-1; Apunta a la posición del segundo carácter visualizado
01AB   0280           00090         subwf   LCD_ApuntaCaracter,F    ; en pantalla, que será el primero en la siguiente
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01AC   29A2           00091         goto    LCD_PrimeraPosicion             ; visualización de línea, para producir el efecto
01AD                  00092 LCD_NoEsFinalLinea                                      ; de desplazamiento hacia la izquierda.
01AD   0800           00093         movf    LCD_ApuntaCaracter,W
01AE   20AA           00094         call    Mensajes                                ; Obtiene el ASCII del carácter apuntado.
01AF   0081           00095         movwf   LCD_ValorCaracter               ; Guarda el valor de carácter.
01B0   0881           00096         movf    LCD_ValorCaracter,F             ; Lo único que hace es posicionar flag Z. En caso
01B1   1903           00097         btfsc   STATUS,Z                                ; que sea "0x00", que es código indicador final 
01B2   29B7           00098         goto    LCD_FinMovimiento               ; de mensaje, sale fuera.
01B3                  00099 LCD_NoUltimoCaracter2
01B3   2201           00100         call    LCD_Caracter                    ; Visualiza el carácter ASCII leído.
01B4   0A82           00101         incf    LCD_CursorPosicion,F    ; Contabiliza el incremento de posición del 
                      00102                                                                         ; cursor en la pantalla.
01B5   0A80           00103         incf    LCD_ApuntaCaracter,F    ; Apunta a la siguiente posición por visualizar.
01B6   29A4           00104         goto    LCD_VisualizaCaracter   ; Vuelve a visualizar el siguiente carácter
01B7                  00105 LCD_FinMovimiento                                       ; de la línea.
01B7   0008           00106         return                                                  ; Vuelve al programa principal.
                      00107         
                      00108 ;       ===================================================================
                      00109 ;         Del libro "MICROCONTROLADOR PIC16F84. DESARROLLO DE PROYECTOS"
                      00110 ;         E. Palacios, F. Remiro y L. López.            www.pic16f84a.com
                      00111 ;         Editorial Ra-Ma.  www.ra-ma.es
                      00112 ;       ===================================================================     
                      00113         
                      00274         INCLUDE  <LCD_4BIT.INC>                 ; Subrutinas de control del LCD.
                      00001 ;**************************** Librería "LCD_4BIT.INC" ***********************************
                      00002 ;
                      00003 ;       ===================================================================
                      00004 ;         Del libro "MICROCONTROLADOR PIC16F84. DESARROLLO DE PROYECTOS"
                      00005 ;         E. Palacios, F. Remiro y L. López.            www.pic16f84a.com
                      00006 ;         Editorial Ra-Ma.  www.ra-ma.es
                      00007 ;       ===================================================================
                      00008 ;
                      00009 ; Estas subrutinas permiten realizar las tareas básicas de control de un módulo LCD de 2
                      00010 ; líneas por 16 caracteres, compatible con el modelo LM016L.
                      00011 ;
                      00012 ; El visualizador LCD está conectado al Puerto B del PIC mediante un bus de 4 bits. Las
                      00013 ; conexiones son:
                      00014 ; -     Las 4 líneas superiores del módulo LCD, pines <DB7:DB4>  se conectan a las 4
                      00015 ;       líneas superiores del Puerto B del PIC, pines <RB7:RB4>.
                      00016 ; -     Pin RS del LCD a la línea RA0 del PIC.
                      00017 ; -     Pin R/W del LCD a la línea RA1 del PIC, o a masa.
                      00018 ; -     Pin Enable del LCD a la línea RA2 del PIC.
                      00019 ;
                      00020 ; Se utilizan llamadas a subrutinas de retardo de tiempo localizadas en la librería
                      00021 ; RETARDOS.INC.
                      00022 ;
                      00023 ; ZONA DE DATOS *********************************************************************
                      00024 
                      00025         CBLOCK
  00000003            00026         LCD_Dato
  00000004            00027         LCD_GuardaDato
  00000005            00028         LCD_GuardaTRISB
  00000006            00029         LCD_Auxiliar1
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000007            00030         LCD_Auxiliar2
                      00031         ENDC
                      00032 
  00000010            00033 LCD_CaracteresPorLinea  EQU     .16                     ; Número de caracteres por línea de la pantalla.
  0000009F            00034 ADCON   EQU             9FH
                      00035 #DEFINE  LCD_PinRS      PORTA,0
                      00036 #DEFINE  LCD_PinRW      PORTA,1
                      00037 #DEFINE  LCD_PinEnable  PORTA,2
                      00038 #DEFINE  LCD_BusDatos   PORTB
                      00039 
                      00040 ; Subrutina "LCD_Inicializa" ------------------------------------------------------------
                      00041 ;
                      00042 ; Inicialización del módulo LCD: Configura funciones del LCD, produce reset por software,
                      00043 ; borra memoria y enciende pantalla. El fabricante especifica que para garantizar la
                      00044 ; configuración inicial hay que hacerla como sigue:
                      00045 ;
01B8                  00046 LCD_Inicializa
01B8   1683           00047         bsf             STATUS,RP0                              ; Configura las líneas conectadas al pin
                            es RS,
01B9   1005           00048         bcf             LCD_PinRS                               ; R/W y E.
01BA   1105           00049         bcf             LCD_PinEnable
01BB   1085           00050         bcf             LCD_PinRW
01BC   3007           00051         MOVLW   0x07 ; Configure all pins
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01BD   009F           00052         MOVWF   ADCON
01BE   1283           00053         bcf             STATUS,RP0
01BF   1085           00054         bcf             LCD_PinRW                               ; En caso de que esté conectado le indic
                            a
                      00055                                                                         ; que se va a escribir en el LCD
                            .
01C0   1105           00056         bcf             LCD_PinEnable                   ; Impide funcionamiento del LCD poniendo E=0.
01C1   1005           00057         bcf     LCD_PinRS                               ; Activa el Modo Comando poniendo RS=0.
01C2   2261           00058         call    Retardo_20ms
01C3   3030           00059         movlw   b'00110000'     
01C4   21D4           00060         call    LCD_EscribeLCD                  ; Escribe el dato en el LCD.
01C5   2265           00061         call    Retardo_5ms     
01C6   3030           00062         movlw   b'00110000'     
01C7   21D4           00063         call    LCD_EscribeLCD
01C8   224E           00064         call    Retardo_200micros
01C9   3030           00065         movlw   b'00110000'     
01CA   21D4           00066         call    LCD_EscribeLCD
01CB   2256           00067         call    Retardo_20micros                ; Este retardo es necesario para simular en PROTEUS.
01CC   3020           00068         movlw   b'00100000'                             ; Interface de 4 bits.
01CD   21D4           00069         call    LCD_EscribeLCD
01CE   2256           00070         call    Retardo_20micros                ; Este retardo es necesario para simular en PROTEUS.
                      00071         
                      00072 ; Ahora configura el resto de los parámetros: 
                      00073 
01CF   21FE           00074         call    LCD_2Lineas4Bits5x7             ; LCD de 2 líneas y caracteres de 5x7 puntos.
01D0   21FC           00075         call    LCD_Borra                               ; Pantalla encendida y limpia. Cursor al princip
                            io
01D1   21FA           00076         call    LCD_CursorOFF                   ; de la línea 1. Cursor apagado.
01D2   21E8           00077         call    LCD_CursorIncr                  ; Cursor en modo incrementar.
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01D3   0008           00078         return
                      00079 
                      00080 ; Subrutina "LCD_EscribeLCD" -----------------------------------------------------------
                      00081 ;
                      00082 ; Envía el dato del registro de trabajo W al bus de dato y produce un pequeño pulso en el pin
                      00083 ; Enable del LCD. Para no alterar el contenido de las líneas de la parte baja del Puerto B que
                      00084 ; no son utilizadas para el LCD (pines RB3:RB0), primero se lee estas líneas y después se
                      00085 ; vuelve a enviar este dato sin cambiarlo.
                      00086 
01D4                  00087 LCD_EscribeLCD
01D4   39F0           00088         andlw   b'11110000'                             ; Se queda con el nibble alto del dato que es el
01D5   0083           00089         movwf   LCD_Dato                                ; que hay que enviar y lo guarda.
01D6   0806           00090         movf    LCD_BusDatos,W                  ; Lee la información actual de la parte baja
01D7   390F           00091         andlw   b'00001111'                             ; del Puerto B, que no se debe alterar.
01D8   0483           00092         iorwf   LCD_Dato,F                              ; Enviará la parte alta del dato de entrada
                      00093                                                                         ; y en la parte baja lo que habí
                            a antes.
01D9   1683           00094         bsf             STATUS,RP0                              ; Acceso al Banco 1.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DA   0806           00095         movf    TRISB,W                                 ; Guarda la configuración que tenía antes TRISB.
01DB   0085           00096         movwf   LCD_GuardaTRISB
01DC   300F           00097         movlw   b'00001111'                             ; Las 4 líneas inferiores del Puerto B se dejan 
01DD   0586           00098         andwf   PORTB,F                                 ; como estaban y las 4 superiores como salida.
01DE   1283           00099         bcf             STATUS,RP0                              ; Acceso al Banco 0.
                      00100 ;
01DF   0803           00101         movf    LCD_Dato,W                              ; Recupera el dato a enviar.
01E0   0086           00102         movwf   LCD_BusDatos                    ; Envía el dato al módulo LCD.
01E1   1505           00103         bsf             LCD_PinEnable                   ; Permite funcionamiento del LCD mediante un peq
                            ueño
01E2   1105           00104         bcf             LCD_PinEnable                   ; pulso y termina impidiendo el funcionamiento d
                            el LCD.
01E3   1683           00105         bsf             STATUS,RP0                              ; Acceso al Banco 1. Restaura el antiguo
                             valor en
01E4   0805           00106         movf    LCD_GuardaTRISB,W               ; la configuración del Puerto B.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E5   0086           00107         movwf   TRISB
01E6   1283           00108         bcf             STATUS,RP0                              ; Acceso al Banco 0.
01E7   0008           00109         return
                      00110 
                      00111 ; Subrutinas variadas para el control del módulo LCD -----------------------------------------
                      00112 ;
                      00113 ;Los comandos que pueden ser ejecutados son:
                      00114 ;
01E8                  00115 LCD_CursorIncr                                          ; Cursor en modo incrementar.
01E8   3006           00116         movlw   b'00000110'
01E9   29FF           00117         goto    LCD_EnviaComando
01EA                  00118 LCD_Linea1                                                      ; Cursor al principio de la Línea 1.
01EA   3080           00119         movlw   b'10000000'                             ; Dirección 00h de la DDRAM
01EB   29FF           00120         goto    LCD_EnviaComando
01EC                  00121 LCD_Linea2                                                      ; Cursor al principio de la Línea 2.
01EC   30C0           00122         movlw   b'11000000'                             ; Dirección 40h de la DDRAM
01ED   29FF           00123         goto    LCD_EnviaComando
01EE                  00124 LCD_Linea3                                                      ; Cursor al principio de la Línea 3
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01EE   3094           00125         movlw   b'10010100'                             ; Dirección 14h de la DDRAM
01EF   29FF           00126         goto    LCD_EnviaComando
01F0                  00127 LCD_Linea4                                                      ; Cursor al principio de la Línea 4
01F0   30D4           00128         movlw   b'11010100'                             ; Dirección 54h de la DDRAM
01F1   29FF           00129         goto    LCD_EnviaComando
01F2                  00130 LCD_PosicionLinea1                                      ; Cursor a posición de la Línea 1, a partir de l
                            a
01F2   3880           00131         iorlw   b'10000000'                             ; dirección 00h de la DDRAM más el valor del
01F3   29FF           00132         goto    LCD_EnviaComando                ; registro W.
01F4                  00133 LCD_PosicionLinea2                                      ; Cursor a posición de la Línea 2, a partir de l
                            a
01F4   38C0           00134         iorlw   b'11000000'                             ; dirección 40h de la DDRAM más el valor del
01F5   29FF           00135         goto    LCD_EnviaComando                ; registro W.
01F6                  00136 LCD_OFF                                                         ; Pantalla apagada.
01F6   3008           00137         movlw   b'00001000'
01F7   29FF           00138         goto    LCD_EnviaComando
01F8                  00139 LCD_CursorON                                            ; Pantalla encendida y cursor encendido.
01F8   300E           00140         movlw   b'00001110'
01F9   29FF           00141         goto    LCD_EnviaComando
01FA                  00142 LCD_CursorOFF                                           ; Pantalla encendida y cursor apagado.
01FA   300C           00143         movlw   b'00001100'
01FB   29FF           00144         goto    LCD_EnviaComando
01FC                  00145 LCD_Borra                                                       ; Borra toda la pantalla, memoria DDRAM 
                            y pone el 
01FC   3001           00146         movlw   b'00000001'                             ; cursor a principio de la línea 1.
01FD   29FF           00147         goto    LCD_EnviaComando
01FE                  00148 LCD_2Lineas4Bits5x7                                     ; Define la pantalla de 2 líneas, con caracteres
01FE   3028           00149         movlw   b'00101000'                             ; de 5x7 puntos y conexión al PIC mediante bus d
                            e
                      00150 ;       goto    LCD_EnviaComando                ; 4 bits. 
                      00151 
                      00152 ; Subrutinas "LCD_EnviaComando" y "LCD_Caracter" ------------------------------------
                      00153 ;
                      00154 ; "LCD_EnviaComando". Escribe un comando en el registro del módulo LCD. La palabra de
                      00155 ; comando ha sido entregada a través del registro W.  Trabaja en Modo Comando.
                      00156 ; "LCD_Caracter". Escribe en la memoria DDRAM del LCD el carácter ASCII introducido a
                      00157 ; a través del registro W. Trabaja en Modo Dato.
                      00158 ;
01FF                  00159 LCD_EnviaComando
01FF   1005           00160         bcf             LCD_PinRS                               ; Activa el Modo Comando, poniendo RS=0.
0200   2A03           00161         goto    LCD_Envia
0201                  00162 LCD_Caracter
0201   1405           00163         bsf             LCD_PinRS                               ; Activa el "Modo Dato", poniendo RS=1.
0202   220B           00164         call    LCD_CodigoCGROM                 ; Obtiene el código para correcta visualización.
0203                  00165 LCD_Envia
0203   0084           00166         movwf   LCD_GuardaDato                  ; Guarda el dato a enviar.
0204   21D4           00167         call    LCD_EscribeLCD                  ; Primero envía el nibble alto.
0205   0E04           00168         swapf   LCD_GuardaDato,W                ; Ahora envía el nibble bajo. Para ello pasa el
                      00169                                                                         ; nibble bajo del dato a enviar 
                            a parte alta del byte.
0206   21D4           00170         call    LCD_EscribeLCD                  ; Se envía al visualizador LCD.
0207   1C05           00171         btfss   LCD_PinRS                               ; Debe garantizar una correcta escritura manteni
                            endo 
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0208   2267           00172         call    Retardo_2ms                             ; 2 ms en modo comando y 50 µs en modo cáracter.
0209   2253           00173         call    Retardo_50micros
020A   0008           00174         return  
                      00175 
                      00176 ; Subrutina "LCD_CodigoCGROM" -----------------------------------------------------------
                      00177 ;
                      00178 ; A partir del carácter ASCII número 127 los códigos de los caracteres definidos en la
                      00179 ; tabla CGROM del LM016L no coinciden con los códigos ASCII. Así por ejemplo, el código
                      00180 ; ASCII de la "Ñ" en la tabla CGRAM del LM016L es EEh.
                      00181 ;
                      00182 ; Esta subrutina convierte los códigos ASCII de la "Ñ", "º" y otros, a códigos CGROM para que
                      00183 ; que puedan ser visualizado en el módulo LM016L.
                      00184 ; 
                      00185 ; Entrada:      En (W) el código ASCII del carácter que se desea visualizar.
                      00186 ; Salida:       En (W) el código definido en la tabla CGROM.
                      00187 
020B                  00188 LCD_CodigoCGROM
020B   0083           00189         movwf   LCD_Dato                                ; Guarda el valor del carácter y comprueba si es
020C                  00190 LCD_EnheMinuscula                                       ; un carácter especial.
020C   3CF1           00191         sublw   'ñ'                                     ; ¿Es la "ñ"?
020D   1D03           00192         btfss   STATUS,Z
020E   2A12           00193         goto    LCD_EnheMayuscula               ; No es "ñ".
020F   30EE           00194         movlw   b'11101110'                             ; Código CGROM de la "ñ".
0210   0083           00195         movwf   LCD_Dato
0211   2A1F           00196         goto    LCD_FinCGROM
0212                  00197 LCD_EnheMayuscula
0212   0803           00198         movf    LCD_Dato,W                              ; Recupera el código ASCII de entrada.
0213   3CD1           00199         sublw   'Ñ'                                     ; ¿Es la "Ñ"?
0214   1D03           00200         btfss   STATUS,Z
0215   2A19           00201         goto    LCD_Grado                               ; No es "Ñ".
0216   30EE           00202         movlw   b'11101110'                             ; Código CGROM de la "ñ". (No hay símbolo para
0217   0083           00203         movwf   LCD_Dato                                ; la "Ñ" mayúscula en la CGROM).
0218   2A1F           00204         goto    LCD_FinCGROM    
0219                  00205 LCD_Grado
0219   0803           00206         movf    LCD_Dato,W                              ; Recupera el código ASCII de entrada.
021A   3CBA           00207         sublw   'º'                                     ; ¿Es el símbolo "º"?
021B   1D03           00208         btfss   STATUS,Z
021C   2A1F           00209         goto    LCD_FinCGROM                    ; No es "º".
021D   30DF           00210         movlw   b'11011111'                             ; Código CGROM del símbolo "º".
021E   0083           00211         movwf   LCD_Dato
021F                  00212 LCD_FinCGROM
021F   0803           00213         movf    LCD_Dato,W                              ; En (W) el código buscado.
0220   0008           00214         return
                      00215 
                      00216 ; Subrutina "LCD_DosEspaciosBlancos" y "LCD_LineaBlanco" --------------------------------
                      00217 ;
                      00218 ; Visualiza espacios en blanco.
                      00219 
0221                  00220 LCD_LineaEnBlanco
0221   3010           00221         movlw   LCD_CaracteresPorLinea
0222   2A28           00222         goto    LCD_EnviaBlancos
0223                  00223 LCD_UnEspacioBlanco
0223   3001           00224         movlw   .1
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0224   2A28           00225         goto    LCD_EnviaBlancos
0225                  00226 LCD_DosEspaciosBlancos
0225   3002           00227         movlw   .2
0226   2A28           00228         goto    LCD_EnviaBlancos
0227                  00229 LCD_TresEspaciosBlancos
0227   3003           00230         movlw   .3
0228                  00231 LCD_EnviaBlancos
0228   0086           00232         movwf   LCD_Auxiliar1                   ; (LCD_Auxiliar1) se utiliza como contador.
0229                  00233 LCD_EnviaOtroBlanco     
0229   3020           00234         movlw   ' '                                             ; Esto es un espacio en blanco.
022A   2201           00235         call    LCD_Caracter                    ; Visualiza tanto espacios en blanco como se
022B   0B86           00236         decfsz  LCD_Auxiliar1,F                 ; haya cargado en (LCD_Auxiliar1).
022C   2A29           00237         goto    LCD_EnviaOtroBlanco
022D   0008           00238         return
                      00239 
                      00240 ; Subrutinas "LCD_ByteCompleto" y "LCD_Byte" --------------------------------------------
                      00241 ;
                      00242 ; Subrutina "LCD_ByteCompleto", visualiza el byte que almacena el registro W en el
                      00243 ; lugar actual de la pantalla. Por ejemplo, si (W)=b'10101110' visualiza "AE".
                      00244 ;
                      00245 ; Subrutina "LCD_Byte" igual que la anterior, pero en caso de que el nibble alto sea cero 
                      00246 ; visualiza en su lugar un espacio en blanco. Por ejemplo si (W)=b'10101110' visualiza "AE"
                      00247 ; y si (W)=b'00001110', visualiza " E" (un espacio blanco delante).
                      00248 ;
                      00249 ; Utilizan la subrutina "LCD_Nibble" que se analiza más adelante.
                      00250 ;
022E                  00251 LCD_Byte
022E   0087           00252         movwf   LCD_Auxiliar2                   ; Guarda el valor de entrada.
022F   39F0           00253         andlw   b'11110000'                             ; Analiza si el nibble alto es cero.
0230   1D03           00254         btfss   STATUS,Z                                ; Si es cero lo apaga.
0231   2A36           00255         goto    LCD_VisualizaAlto               ; No es cero y lo visualiza.
0232   3020           00256         movlw   ' '                                             ; Visualiza un espacio en blanco.
0233   2201           00257         call    LCD_Caracter
0234   2A38           00258         goto    LCD_VisualizaBajo
                      00259 
0235                  00260 LCD_ByteCompleto
0235   0087           00261         movwf   LCD_Auxiliar2                   ; Guarda el valor de entrada.
0236                  00262 LCD_VisualizaAlto
0236   0E07           00263         swapf   LCD_Auxiliar2,W                 ; Pone el nibble alto en la parte baja.
0237   2239           00264         call    LCD_Nibble                              ; Lo visualiza.
0238                  00265 LCD_VisualizaBajo
0238   0807           00266         movf    LCD_Auxiliar2,W                 ; Repite el proceso con el nibble bajo.
                      00267 ;       call    LCD_Nibble                              ; Lo visualiza.
                      00268 ;       return
                      00269 
                      00270 ; Subrutina "LCD_Nibble" ----------------------------------------------------------------
                      00271 ;
                      00272 ; Visualiza en el lugar actual de la pantalla, el valor hexadecimal que almacena en el nibble
                      00273 ; bajo del registro W. El nibble alto de W no es tenido en cuenta. Ejemplos:
                      00274 ; - Si (W)=b'01010110', se visualizará "6". 
                      00275 ; - Si (W)=b'10101110', se visualizará "E". 
                      00276 ;
0239                  00277 LCD_Nibble
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0239   390F           00278         andlw   b'00001111'                             ; Se queda con la parte baja.
023A   0086           00279         movwf   LCD_Auxiliar1                   ; Lo guarda.
023B   3C09           00280         sublw   0x09                                    ; Comprueba si hay que representarlo con letra.
023C   1C03           00281         btfss   STATUS,C        
023D   2A41           00282         goto    LCD_EnviaByteLetra
023E   0806           00283         movf    LCD_Auxiliar1,W
023F   3E30           00284         addlw   '0'                                             ; El número se pasa a carácter ASCII sum
                            ándole
0240   2A43           00285         goto    LCD_FinVisualizaDigito  ; el ASCII del cero y lo visualiza.
0241                  00286 LCD_EnviaByteLetra
0241   0806           00287         movf    LCD_Auxiliar1,W
0242   3E37           00288         addlw   'A'-0x0A                                ; Sí, por tanto, se le suma el ASCII de la 'A'.
0243                  00289 LCD_FinVisualizaDigito
0243   2A01           00290         goto    LCD_Caracter                    ; Y visualiza el carácter. Se hace con un "goto"
                      00291                                                                         ; para no sobrecargar la pila.
                      00292                                                 
                      00293 ;       ===================================================================
                      00294 ;         Del libro "MICROCONTROLADOR PIC16F84. DESARROLLO DE PROYECTOS"
                      00295 ;         E. Palacios, F. Remiro y L. López.            www.pic16f84a.com
                      00296 ;         Editorial Ra-Ma.  www.ra-ma.es
                      00297 ;       ===================================================================
                      00275         INCLUDE  <RETARDOS.INC>                 ; Subrutinas de retardos.
                      00001 ;**************************** Librería "RETARDOS.INC" *********************************
                      00002 ;
                      00003 ;       ===================================================================
                      00004 ;         Del libro "MICROCONTROLADOR PIC16F84. DESARROLLO DE PROYECTOS"
                      00005 ;         E. Palacios, F. Remiro y L. López.            www.pic16f84a.com
                      00006 ;         Editorial Ra-Ma.  www.ra-ma.es
                      00007 ;       ===================================================================
                      00008 ;
                      00009 ; Librería con múltiples subrutinas de retardos, desde 4 microsegundos hasta 20 segundos. 
                      00010 ; Además se pueden implementar otras subrutinas muy fácilmente.
                      00011 ;
                      00012 ; Se han calculado para un sistema microcontrolador con un PIC trabajando con un cristal
                      00013 ; de cuarzo a 4 MHz. Como cada ciclo máquina son 4 ciclos de reloj, resulta que cada
                      00014 ; ciclo máquina tarda 4 x 1/4MHz = 1 µs.
                      00015 ;
                      00016 ; En los comentarios, "cm" significa "ciclos máquina".
                      00017 ;
                      00018 ; ZONA DE DATOS *********************************************************************
                      00019 
                      00020         CBLOCK
  00000008            00021         R_ContA                                         ; Contadores para los retardos.
  00000009            00022         R_ContB
  0000000A            00023         R_ContC
                      00024         ENDC
                      00025 ;
                      00026 ; RETARDOS de 4 hasta 10 microsegundos ---------------------------------------------------
                      00027 ;
                      00028 ; A continuación retardos pequeños teniendo en cuenta que para una frecuencia de 4 MHZ,
                      00029 ; la llamada a subrutina "call" tarda 2 ciclos máquina, el retorno de subrutina
                      00030 ; "return" toma otros 2 ciclos máquina y cada instrucción "nop" tarda 1 ciclo máquina.
                      00031 ;
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0244                  00032 Retardo_10micros                                ; La llamada "call" aporta 2 ciclos máquina.
0244   0000           00033         nop                                                     ; Aporta 1 ciclo máquina.
0245   0000           00034         nop                                                     ; Aporta 1 ciclo máquina.
0246   0000           00035         nop                                                     ; Aporta 1 ciclo máquina.
0247   0000           00036         nop                                                     ; Aporta 1 ciclo máquina.
0248   0000           00037         nop                                                     ; Aporta 1 ciclo máquina.
0249                  00038 Retardo_5micros                                 ; La llamada "call" aporta 2 ciclos máquina.
0249   0000           00039         nop                                                     ; Aporta 1 ciclo máquina.
024A                  00040 Retardo_4micros                                 ; La llamada "call" aporta 2 ciclos máquina.
024A   0008           00041         return                                          ; El salto del retorno aporta 2 ciclos máquina.
                      00042 ;
                      00043 ; RETARDOS de 20 hasta 500 microsegundos ------------------------------------------------
                      00044 ;
024B                  00045 Retardo_500micros                               ; La llamada "call" aporta 2 ciclos máquina.
024B   0000           00046         nop                                                     ; Aporta 1 ciclo máquina.
024C   30A4           00047         movlw   d'164'                          ; Aporta 1 ciclo máquina. Este es el valor de "K".
024D   2A57           00048         goto    RetardoMicros           ; Aporta 2 ciclos máquina.
024E                  00049 Retardo_200micros                               ; La llamada "call" aporta 2 ciclos máquina.
024E   0000           00050         nop                                                     ; Aporta 1 ciclo máquina.
024F   3040           00051         movlw   d'64'                           ; Aporta 1 ciclo máquina. Este es el valor de "K".
0250   2A57           00052         goto    RetardoMicros           ; Aporta 2 ciclos máquina.
0251                  00053 Retardo_100micros                               ; La llamada "call" aporta 2 ciclos máquina.
0251   301F           00054         movlw   d'31'                           ; Aporta 1 ciclo máquina. Este es el valor de "K".
0252   2A57           00055         goto    RetardoMicros           ; Aporta 2 ciclos máquina.
0253                  00056 Retardo_50micros                                ; La llamada "call" aporta 2 ciclos máquina.
0253   0000           00057         nop                                                     ; Aporta 1 ciclo máquina.
0254   300E           00058         movlw   d'14'                           ; Aporta 1 ciclo máquina. Este es el valor de "K".
0255   2A57           00059         goto    RetardoMicros           ; Aporta 2 ciclos máquina.
0256                  00060 Retardo_20micros                                ; La llamada "call" aporta 2 ciclos máquina.
0256   3005           00061         movlw   d'5'                            ; Aporta 1 ciclo máquina. Este es el valor de "K".
                      00062 ;
                      00063 ; El próximo bloque "RetardoMicros" tarda:
                      00064 ; 1 + (K-1) + 2 + (K-1)x2 + 2 = (2 + 3K) ciclos máquina.
                      00065 ;
0257                  00066 RetardoMicros
0257   0088           00067         movwf   R_ContA                         ; Aporta 1 ciclo máquina.
0258                  00068 Rmicros_Bucle
0258   0B88           00069         decfsz  R_ContA,F                       ; (K-1)x1 cm (cuando no salta) + 2 cm (al saltar).
0259   2A58           00070         goto    Rmicros_Bucle           ; Aporta (K-1)x2 ciclos máquina.
025A   0008           00071         return                                          ; El salto del retorno aporta 2 ciclos máquina.
                      00072 ;
                      00073 ;En total estas subrutinas tardan:
                      00074 ; - Retardo_500micros:  2 + 1 + 1 + 2 + (2 + 3K) = 500 cm = 500 µs. (para K=164 y 4 MHz).
                      00075 ; - Retardo_200micros:  2 + 1 + 1 + 2 + (2 + 3K) = 200 cm = 200 µs. (para K= 64 y 4 MHz).
                      00076 ; - Retardo_100micros:  2     + 1 + 2 + (2 + 3K) = 100 cm = 100 µs. (para K= 31 y 4 MHz).
                      00077 ; - Retardo_50micros :  2 + 1 + 1 + 2 + (2 + 3K) =  50 cm =  50 µs. (para K= 14 y 4 MHz).
                      00078 ; - Retardo_20micros :  2     + 1     + (2 + 3K) =  20 cm =  20 µs. (para K=  5 y 4 MHz).
                      00079 ;
                      00080 ; RETARDOS de 1 ms hasta 200 ms. --------------------------------------------------------
                      00081 ;
025B                  00082 Retardo_200ms                                   ; La llamada "call" aporta 2 ciclos máquina.
025B   30C8           00083         movlw   d'200'                          ; Aporta 1 ciclo máquina. Este es el valor de "M".
025C   2A6A           00084         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

025D                  00085 Retardo_100ms                                   ; La llamada "call" aporta 2 ciclos máquina.
025D   3064           00086         movlw   d'100'                          ; Aporta 1 ciclo máquina. Este es el valor de "M".
025E   2A6A           00087         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
025F                  00088 Retardo_50ms                                    ; La llamada "call" aporta 2 ciclos máquina.
025F   3032           00089         movlw   d'50'                           ; Aporta 1 ciclo máquina. Este es el valor de "M".
0260   2A6A           00090         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
0261                  00091 Retardo_20ms                                    ; La llamada "call" aporta 2 ciclos máquina.
0261   3014           00092         movlw   d'20'                           ; Aporta 1 ciclo máquina. Este es el valor de "M".
0262   2A6A           00093         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
0263                  00094 Retardo_10ms                                    ; La llamada "call" aporta 2 ciclos máquina.
0263   300A           00095         movlw   d'10'                           ; Aporta 1 ciclo máquina. Este es el valor de "M".
0264   2A6A           00096         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
0265                  00097 Retardo_5ms                                             ; La llamada "call" aporta 2 ciclos máquina.
0265   3005           00098         movlw   d'5'                            ; Aporta 1 ciclo máquina. Este es el valor de "M".
0266   2A6A           00099         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
0267                  00100 Retardo_2ms                                             ; La llamada "call" aporta 2 ciclos máquina.
0267   3002           00101         movlw   d'2'                            ; Aporta 1 ciclo máquina. Este es el valor de "M".
0268   2A6A           00102         goto    Retardos_ms                     ; Aporta 2 ciclos máquina.
0269                  00103 Retardo_1ms                                             ; La llamada "call" aporta 2 ciclos máquina.
0269   3001           00104         movlw   d'1'                            ; Aporta 1 ciclo máquina. Este es el valor de "M".
                      00105 ;
                      00106 ; El próximo bloque "Retardos_ms" tarda:
                      00107 ; 1 + M + M + KxM + (K-1)xM + Mx2 + (K-1)Mx2 + (M-1) + 2 + (M-1)x2 + 2 =
                      00108 ; = (2 + 4M + 4KM) ciclos máquina. Para K=249 y M=1 supone 1002 ciclos máquina
                      00109 ; que a 4 MHz son 1002 µs = 1 ms.
                      00110 ;
026A                  00111 Retardos_ms
026A   0089           00112         movwf   R_ContB                         ; Aporta 1 ciclo máquina.
026B                  00113 R1ms_BucleExterno
026B   30F9           00114         movlw   d'249'                          ; Aporta Mx1 ciclos máquina. Este es el valor de "K".
026C   0088           00115         movwf   R_ContA                         ; Aporta Mx1 ciclos máquina.
026D                  00116 R1ms_BucleInterno
026D   0000           00117         nop                                                     ; Aporta KxMx1 ciclos máquina.
026E   0B88           00118         decfsz  R_ContA,F                       ; (K-1)xMx1 cm (cuando no salta) + Mx2 cm (al saltar).
026F   2A6D           00119         goto    R1ms_BucleInterno       ; Aporta (K-1)xMx2 ciclos máquina.
0270   0B89           00120         decfsz  R_ContB,F                       ; (M-1)x1 cm (cuando no salta) + 2 cm (al saltar).
0271   2A6B           00121         goto    R1ms_BucleExterno       ; Aporta (M-1)x2 ciclos máquina.
0272   0008           00122         return                                          ; El salto del retorno aporta 2 ciclos máquina.
                      00123 ;
                      00124 ;En total estas subrutinas tardan:
                      00125 ; - Retardo_200ms:      2 + 1 + 2 + (2 + 4M + 4KM) = 200007 cm = 200 ms. (M=200 y K=249).
                      00126 ; - Retardo_100ms:      2 + 1 + 2 + (2 + 4M + 4KM) = 100007 cm = 100 ms. (M=100 y K=249).
                      00127 ; - Retardo_50ms :      2 + 1 + 2 + (2 + 4M + 4KM) =  50007 cm =  50 ms. (M= 50 y K=249).
                      00128 ; - Retardo_20ms :      2 + 1 + 2 + (2 + 4M + 4KM) =  20007 cm =  20 ms. (M= 20 y K=249).
                      00129 ; - Retardo_10ms :      2 + 1 + 2 + (2 + 4M + 4KM) =  10007 cm =  10 ms. (M= 10 y K=249).
                      00130 ; - Retardo_5ms  :      2 + 1 + 2 + (2 + 4M + 4KM) =   5007 cm =   5 ms. (M=  5 y K=249).
                      00131 ; - Retardo_2ms  :      2 + 1 + 2 + (2 + 4M + 4KM) =   2007 cm =   2 ms. (M=  2 y K=249).
                      00132 ; - Retardo_1ms  :      2 + 1     + (2 + 4M + 4KM) =   1005 cm =   1 ms. (M=  1 y K=249).
                      00133 ;
                      00134 ; RETARDOS de 0.5 hasta 20 segundos ---------------------------------------------------
                      00135 ;
0273                  00136 Retardo_20s                                             ; La llamada "call" aporta 2 ciclos máquina.
0273   30C8           00137         movlw   d'200'                          ; Aporta 1 ciclo máquina. Este es el valor de "N".
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0274   2A7E           00138         goto    Retardo_1Decima         ; Aporta 2 ciclos máquina.
0275                  00139 Retardo_10s                                             ; La llamada "call" aporta 2 ciclos máquina.
0275   3064           00140         movlw   d'100'                          ; Aporta 1 ciclo máquina. Este es el valor de "N".
0276   2A7E           00141         goto    Retardo_1Decima         ; Aporta 2 ciclos máquina.
0277                  00142 Retardo_5s                                              ; La llamada "call" aporta 2 ciclos máquina.
0277   3032           00143         movlw   d'50'                           ; Aporta 1 ciclo máquina. Este es el valor de "N".
0278   2A7E           00144         goto    Retardo_1Decima         ; Aporta 2 ciclos máquina.
0279                  00145 Retardo_2s                                              ; La llamada "call" aporta 2 ciclos máquina.
0279   3014           00146         movlw   d'20'                           ; Aporta 1 ciclo máquina. Este es el valor de "N".
027A   2A7E           00147         goto    Retardo_1Decima         ; Aporta 2 ciclos máquina.
027B                  00148 Retardo_1s                                              ; La llamada "call" aporta 2 ciclos máquina.
027B   300A           00149         movlw   d'10'                           ; Aporta 1 ciclo máquina. Este es el valor de "N".
027C   2A7E           00150         goto    Retardo_1Decima         ; Aporta 2 ciclos máquina.
027D                  00151 Retardo_500ms                                   ; La llamada "call" aporta 2 ciclos máquina.
027D   3005           00152         movlw   d'5'                            ; Aporta 1 ciclo máquina. Este es el valor de "N".
                      00153 ;
                      00154 ; El próximo bloque "Retardo_1Decima" tarda:
                      00155 ; 1 + N + N + MxN + MxN + KxMxN + (K-1)xMxN + MxNx2 + (K-1)xMxNx2 +
                      00156 ;   + (M-1)xN + Nx2 + (M-1)xNx2 + (N-1) + 2 + (N-1)x2 + 2 =
                      00157 ; = (2 + 4M + 4MN + 4KM) ciclos máquina. Para K=249, M=100 y N=1 supone 100011
                      00158 ; ciclos máquina que a 4 MHz son 100011 µs = 100 ms = 0,1 s = 1 décima de segundo.
                      00159 ;
027E                  00160 Retardo_1Decima
027E   008A           00161         movwf   R_ContC                         ; Aporta 1 ciclo máquina.
027F                  00162 R1Decima_BucleExterno2
027F   3064           00163         movlw   d'100'                          ; Aporta Nx1 ciclos máquina. Este es el valor de "M".
0280   0089           00164         movwf   R_ContB                         ; Aporta Nx1 ciclos máquina.
0281                  00165 R1Decima_BucleExterno
0281   30F9           00166         movlw   d'249'                          ; Aporta MxNx1 ciclos máquina. Este es el valor de "K".
0282   0088           00167         movwf   R_ContA                         ; Aporta MxNx1 ciclos máquina.
0283                  00168 R1Decima_BucleInterno          
0283   0000           00169         nop                                                     ; Aporta KxMxNx1 ciclos máquina.
0284   0B88           00170         decfsz  R_ContA,F                       ; (K-1)xMxNx1 cm (si no salta) + MxNx2 cm (al saltar).
0285   2A83           00171         goto    R1Decima_BucleInterno   ; Aporta (K-1)xMxNx2 ciclos máquina.
0286   0B89           00172         decfsz  R_ContB,F                       ; (M-1)xNx1 cm (cuando no salta) + Nx2 cm (al saltar).
0287   2A81           00173         goto    R1Decima_BucleExterno   ; Aporta (M-1)xNx2 ciclos máquina.
0288   0B8A           00174         decfsz  R_ContC,F                       ; (N-1)x1 cm (cuando no salta) + 2 cm (al saltar).
0289   2A7F           00175         goto    R1Decima_BucleExterno2  ; Aporta (N-1)x2 ciclos máquina.
028A   0008           00176         return                                          ; El salto del retorno aporta 2 ciclos máquina.
                      00177 ;
                      00178 ;En total estas subrutinas tardan:
                      00179 ; - Retardo_20s:        2 + 1 + 2 + (2 + 4N + 4MN + 4KMN) = 20000807 cm = 20 s.
                      00180 ;                       (N=200, M=100 y K=249).
                      00181 ; - Retardo_10s:        2 + 1 + 2 + (2 + 4N + 4MN + 4KMN) = 10000407 cm = 10 s.
                      00182 ;                       (N=100, M=100 y K=249).
                      00183 ; - Retardo_5s:         2 + 1 + 2 + (2 + 4N + 4MN + 4KMN) =  5000207 cm =  5 s.
                      00184 ;                       (N= 50, M=100 y K=249).
                      00185 ; - Retardo_2s:         2 + 1 + 2 + (2 + 4N + 4MN + 4KMN) =  2000087 cm =  2 s.
                      00186 ;                       (N= 20, M=100 y K=249).
                      00187 ; - Retardo_1s:         2 + 1 + 2 + (2 + 4N + 4MN + 4KMN) =  1000047 cm =  1 s.
                      00188 ;                       (N= 10, M=100 y K=249).
                      00189 ; - Retardo_500ms:      2 + 1     + (2 + 4N + 4MN + 4KMN) =   500025 cm = 0,5 s.
                      00190 ;                       (N=  5, M=100 y K=249).
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00191 
                      00192 ;       ===================================================================
                      00193 ;         Del libro "MICROCONTROLADOR PIC16F84. DESARROLLO DE PROYECTOS"
                      00194 ;         E. Palacios, F. Remiro y L. López.            www.pic16f84a.com
                      00195 ;         Editorial Ra-Ma.  www.ra-ma.es
                      00196 ;       ===================================================================
                      00197 
                      00198 
                      00199 
                      00200 
                      00276 
                      00277 
                      00278 
028B   30FF           00279 DELAY   MOVLW   0xFF;                   ;*DELAY         
028C   008C           00280                 MOVWF   CONT0
028D   30FF           00281 J2              MOVLW   0xFF
028E   009C           00282                 MOVWF   CONT1
028F   039C           00283 J1              DECF    CONT1,1
0290   3000           00284                 MOVLW   0x00                    ; W<-0
0291   1103           00285                 BCF             ESTADO,2                ; Z<-0
0292   021C           00286                 SUBWF   CONT1,0                 ; W<-RESULTADO SI W=0 SO Z=1
0293   1D03           00287                 BTFSS   ESTADO,2                ; Z=1?
0294   2A8F           00288                 GOTO    J1
0295   038C           00289                 DECF    CONT0,1
0296   3000           00290                 MOVLW   0x00                    ; W<-0
0297   1103           00291                 BCF             ESTADO,2                ; Z<-0
0298   020C           00292                 SUBWF   CONT0,0                 ; W<-RESULTADO SI W=0 SO Z=1
0299   1D03           00293                 BTFSS   ESTADO,2                ; Z=1?
029A   2A8D           00294                 GOTO    J2
029B   0008           00295                 RETURN
029C                  00296 DELAY2
029C   228B           00297                 CALL    DELAY
029D   228B           00298                 CALL    DELAY
Warning[203]: Found opcode in column 1. (RETURN)
029E   0008           00299 RETURN
                      00300 
                      00301                 END
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON                             0000009F
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
AUX                               0000000F
AUX2                              0000001C
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CAFECAPUCCINO                     0000007D
CAFEEXPRESS                       00000071
CAFELECHE                         00000065
CAFEPURO                          00000059
CAMBIO                            0000008B
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2H                            0000001C
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 22


SYMBOL TABLE
  LABEL                             VALUE 

CCPR2L                            0000001B
CHECK                             00000049
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
CKP                               00000004
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
CONT0                             0000000C
CONT1                             0000001C
CREN                              00000004
CSRC                              00000007
CUANTODECAMBIO                    00000088
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DELAY                             0000028B
DELAY2                            0000029C
D_A                               00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
ES1BS                             00000016
ES2BS                             00000022
ES5BS                             0000002E
ESTADO                            00000003
F                                 00000001
FERR                              00000002
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INICIO                            00000001
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
J1                                0000028F
J2                                0000028D
LCD_2Lineas4Bits5x7               000001FE
LCD_ApuntaCaracter                00000000
LCD_Auxiliar1                     00000006
LCD_Auxiliar2                     00000007
LCD_Borra                         000001FC
LCD_BusDatos                      PORTB
LCD_Byte                          0000022E
LCD_ByteCompleto                  00000235
LCD_Caracter                      00000201
LCD_CaracteresPorLinea            00000010
LCD_CodigoCGROM                   0000020B
LCD_CursorIncr                    000001E8
LCD_CursorOFF                     000001FA
LCD_CursorON                      000001F8
LCD_CursorPosicion                00000002
LCD_Dato                          00000003
LCD_DosEspaciosBlancos            00000225
LCD_EnheMayuscula                 00000212
LCD_EnheMinuscula                 0000020C
LCD_Envia                         00000203
LCD_EnviaBlancos                  00000228
LCD_EnviaByteLetra                00000241
LCD_EnviaComando                  000001FF
LCD_EnviaOtroBlanco               00000229
LCD_EsFinalLinea                  000001A8
LCD_EscribeLCD                    000001D4
LCD_FinCGROM                      0000021F
LCD_FinMensaje                    0000019D
LCD_FinMovimiento                 000001B7
LCD_FinVisualizaDigito            00000243
LCD_Grado                         00000219
LCD_GuardaDato                    00000004
LCD_GuardaTRISB                   00000005
LCD_Inicializa                    000001B8
LCD_Linea1                        000001EA
LCD_Linea2                        000001EC
LCD_Linea3                        000001EE
LCD_Linea4                        000001F0
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

LCD_LineaEnBlanco                 00000221
LCD_Mensaje                       00000190
LCD_MensajeMovimiento             0000019E
LCD_Nibble                        00000239
LCD_NoEsFinalLinea                000001AD
LCD_NoUltimoCaracter              0000019A
LCD_NoUltimoCaracter2             000001B3
LCD_OFF                           000001F6
LCD_PinEnable                     PORTA,2
LCD_PinRS                         PORTA,0
LCD_PinRW                         PORTA,1
LCD_PosicionLinea1                000001F2
LCD_PosicionLinea2                000001F4
LCD_PrimeraPosicion               000001A2
LCD_TresEspaciosBlancos           00000227
LCD_UnEspacioBlanco               00000223
LCD_ValorCaracter                 00000001
LCD_VisualizaAlto                 00000236
LCD_VisualizaBajo                 00000238
LCD_VisualizaCaracter             000001A4
LCD_VisualizaOtroCaracter         00000194
LEDAMAR                           PORTC,5
LEDAZUL                           PORTC,7
LEDROJO                           PORTC,3
LEDROJO2                          PORTC,4
LEDVERD                           PORTC,6
MONTO                             0000000E
MONTODEMAS                        0000003D
MOSTRAR                           0000003A
MOSTRAR2                          00000051
MSJ1                              00000095
MSJ2                              0000009E
MSJ3                              000000A2
MSJ4                              000000A6
Mensaje1                          000000AB
Mensaje11                         0000010D
Mensaje2                          00000146
Mensaje3                          00000156
Mensaje4                          00000167
Mensajes                          000000AA
MensajesA                         00000146
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
R1Decima_BucleExterno             00000281
R1Decima_BucleExterno2            0000027F
R1Decima_BucleInterno             00000283
R1ms_BucleExterno                 0000026B
R1ms_BucleInterno                 0000026D
RBIE                              00000003
RBIF                              00000000
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RSEN                              00000001
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

RX9                               00000006
RX9D                              00000000
R_ContA                           00000008
R_ContB                           00000009
R_ContC                           0000000A
R_W                               00000002
RetardoMicros                     00000257
Retardo_100micros                 00000251
Retardo_100ms                     0000025D
Retardo_10micros                  00000244
Retardo_10ms                      00000263
Retardo_10s                       00000275
Retardo_1Decima                   0000027E
Retardo_1ms                       00000269
Retardo_1s                        0000027B
Retardo_200micros                 0000024E
Retardo_200ms                     0000025B
Retardo_20micros                  00000256
Retardo_20ms                      00000261
Retardo_20s                       00000273
Retardo_2ms                       00000267
Retardo_2s                        00000279
Retardo_4micros                   0000024A
Retardo_500micros                 0000024B
Retardo_500ms                     0000027D
Retardo_50micros                  00000253
Retardo_50ms                      0000025F
Retardo_5micros                   00000249
Retardo_5ms                       00000265
Retardo_5s                        00000277
Retardos_ms                       0000026A
Rmicros_Bucle                     00000258
S                                 00000003
SELECCAFE                         00000041
SEN                               00000000
SINC                              0000008D
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

START                             0000000F
START2                            00000054
STATUS                            00000003
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
TRISD                             00000088
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 28


SYMBOL TABLE
  LABEL                             VALUE 

W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_HS_OSC                           00003FFE
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001
__DEBUG                           1


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXX- ---------------- ----------------
2000 : -------X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   671
Program Memory Words Free:  7521

MPASM  5.35                         CAFE0.ASM   5-25-2011  13:34:33         PAGE 29






Errors   :     0
Warnings :    18 reported,     0 suppressed
Messages :    16 reported,     0 suppressed

